<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Carbon Atom (Electronic Structure)</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <!-- Library to make text always face the user -->
  <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
</head>

<body>
  <script>
    // 1. ANIMATION: Moves electrons around orbits
    AFRAME.registerComponent('orbit-animation', {
      schema: { speed: {type: 'number', default: 1} },
      tick: function (time, timeDelta) {
        var rotation = this.el.getAttribute('rotation');
        this.el.setAttribute('rotation', {
          x: rotation.x,
          y: rotation.y + (this.data.speed * (timeDelta / 10)),
          z: rotation.z
        });
      }
    });

    // 2. INTERACTION: Swipe screen to rotate the whole atom
    AFRAME.registerComponent('scene-rotation-handler', {
      init: function () {
        this.atom = document.querySelector('#carbon-model');
        this.isDragging = false;
        this.startMouseX = 0;
        this.currentRotationY = 0;

        document.addEventListener('touchstart', (evt) => {
          this.isDragging = true;
          this.startMouseX = evt.touches[0].clientX;
          this.currentRotationY = this.atom.object3D.rotation.y;
        });

        document.addEventListener('touchmove', (evt) => {
          if (!this.isDragging) return;
          var distance = evt.touches[0].clientX - this.startMouseX;
          // Divide by 150 to control sensitivity
          this.atom.object3D.rotation.y = this.currentRotationY + (distance / 150);
        });

        document.addEventListener('touchend', () => {
          this.isDragging = false;
        });
      }
    });
  </script>

  <!-- THE SCENE -->
  <a-scene 
    vr-mode-ui="enabled: true" 
    renderer="antialias: true; colorManagement: true; alpha: true"
    scene-rotation-handler>

    <!-- LIGHTING (High quality studio lights) -->
    <a-light type="directional" intensity="2" position="-2 4 4" color="#ffffff"></a-light>
    <a-light type="directional" intensity="1" position="2 -2 2" color="#aaccff"></a-light>
    <a-light type="ambient" intensity="0.5" color="#333"></a-light>

    <!-- MAIN ATOM GROUP -->
    <a-entity id="carbon-model" position="0 1.5 -3" scale="0.4 0.4 0.4">
      
      <!-- TITLE LABEL (Floating above) -->
      <a-text value="CARBON (C)" position="0 4 0" align="center" width="8" color="white" look-at="[camera]"></a-text>
      <a-text value="Atomic No: 6" position="0 3.5 0" align="center" width="5" color="#AAA" look-at="[camera]"></a-text>

      <!-- 1. NUCLEUS (6 Protons, 6 Neutrons) -->
      <a-entity animation="property: rotation; to: 360 360 0; loop: true; dur: 25000; easing: linear">
        <!-- Reusable shapes -->
        <a-mixin id="proton" geometry="primitive: sphere; radius: 0.3" material="color: #FF0055; metalness: 0.6; roughness: 0.2"></a-mixin>
        <a-mixin id="neutron" geometry="primitive: sphere; radius: 0.3" material="color: #00DDFF; metalness: 0.6; roughness: 0.2"></a-mixin>

        <!-- The Cluster -->
        <a-entity mixin="proton" position="0.2 0.2 0"></a-entity>
        <a-entity mixin="neutron" position="-0.2 -0.2 0"></a-entity>
        <a-entity mixin="proton" position="0.2 -0.2 0.25"></a-entity>
        <a-entity mixin="neutron" position="-0.2 0.2 0.1"></a-entity>
        <a-entity mixin="proton" position="0 0 -0.3"></a-entity>
        <a-entity mixin="neutron" position="0.1 0.1 -0.1"></a-entity>
        <a-entity mixin="proton" position="-0.3 0 0.1"></a-entity>
        <a-entity mixin="neutron" position="0.3 -0.1 0"></a-entity>
        <a-entity mixin="proton" position="0 -0.3 -0.1"></a-entity>
        <a-entity mixin="neutron" position="0 0.3 0.1"></a-entity>
        <a-entity mixin="proton" position="-0.1 0.2 -0.2"></a-entity>
        <a-entity mixin="neutron" position="0.1 -0.2 0.2"></a-entity>
      </a-entity>

      <!-- 2. INNER SHELL (K-Shell) - 2 Electrons -->
      <a-entity>
         <!-- The Ring -->
         <a-torus radius="1.8" radius-tubular="0.02" rotation="90 0 0" color="#555" opacity="0.5"></a-torus>
         <!-- Label -->
         <a-text value="K-Shell (2)" position="2 0 0" color="#00DDFF" width="5" look-at="[camera]"></a-text>
         
         <!-- Rotating Electrons -->
         <a-entity rotation="0 0 20" orbit-animation="speed: 4">
            <!-- Electron 1 -->
            <a-sphere position="1.8 0 0" radius="0.15" color="#00DDFF" material="emissive: #00DDFF; emissiveIntensity: 1"></a-sphere>
            <!-- Electron 2 -->
            <a-sphere position="-1.8 0 0" radius="0.15" color="#00DDFF" material="emissive: #00DDFF; emissiveIntensity: 1"></a-sphere>
         </a-entity>
      </a-entity>

      <!-- 3. OUTER SHELL (L-Shell / Valence) - 4 Electrons -->
      <a-entity>
         <!-- The Ring -->
         <a-torus radius="3.0" radius-tubular="0.02" rotation="90 0 0" color="#555" opacity="0.5"></a-torus>
         <!-- Label -->
         <a-text value="Valence Shell (4)" position="3.2 0 0" color="#FFD700" width="5" look-at="[camera]"></a-text>

         <!-- Rotating Electrons -->
         <a-entity rotation="30 40 0" orbit-animation="speed: 2.5">
            <!-- Electron 3 -->
            <a-sphere position="3.0 0 0" radius="0.18" color="#FFD700" material="emissive: #FFD700; emissiveIntensity: 1"></a-sphere>
            <!-- Electron 4 -->
            <a-sphere position="-3.0 0 0" radius="0.18" color="#FFD700" material="emissive: #FFD700; emissiveIntensity: 1"></a-sphere>
         </a-entity>

         <a-entity rotation="-30 -40 0" orbit-animation="speed: 3">
            <!-- Electron 5 -->
            <a-sphere position="0 0 3.0" radius="0.18" color="#FFD700" material="emissive: #FFD700; emissiveIntensity: 1"></a-sphere>
            <!-- Electron 6 -->
            <a-sphere position="0 0 -3.0" radius="0.18" color="#FFD700" material="emissive: #FFD700; emissiveIntensity: 1"></a-sphere>
         </a-entity>
      </a-entity>

      <!-- LEGEND (Key at bottom) -->
      <a-entity position="0 -4 0" look-at="[camera]">
         <a-sphere position="-2 0 0" radius="0.2" color="#FF0055"></a-sphere>
         <a-text value="Proton" position="-1.6 0 0" width="4"></a-text>

         <a-sphere position="-0.5 0 0" radius="0.2" color="#00DDFF"></a-sphere>
         <a-text value="Neutron" position="-0.1 0 0" width="4"></a-text>

         <a-sphere position="1.2 0 0" radius="0.2" color="#FFD700"></a-sphere>
         <a-text value="Valence e-" position="1.6 0 0" width="4"></a-text>
      </a-entity>

    </a-entity>
  </a-scene>
</body>
</html>
